## Wat is DHCP?

Het Dynamic Host Configuration Protocol (DHCP) is een integraal onderdeel van netwerken. Het is een bepaalde server role en bepaalt welke ![](https://cdn.talentlms.com/it1education/1635064430_dhcp.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwNjQ0MzBfZGhjcC5wbmciLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3MTE3NTY4MDB9fX1dfQ__&Signature=NpduyDpBgHZpZXSyPRauEvX%2FU%2FvAoy2ztVgwST2WhMefJqkm%2Fbeu5Isf%2Fgk99CHfjtK7Y3roS3yMpA%2FjpMhqSLgDbAdDTk6GyEP%2FtD9g4ZWDlw6jMScpj4FWD-xBd9QjyntRPiGUmOosuoh-mzmWERO7qMD%2FKwXbXWdGa%2FBMxsMK9ErhVQ56TcNzYRAD8%2FX2DPghDpZcEayUsN5LCQMZav44IrS3Ks7vUoYNyj1zhnDV-eBtDDc5i9Oh44PepVWHPY4Z%2F%2FoVluOSR6vLDw5KN4MlH8lIfBCja1KG4YN4GHOxmyxcCBk81YjWBcccjXySqURkQOi1piS%2F7MzrxEHvdA__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)IP-adressen apparaten ontvangen zodat ze met elkaar en met het internet kunnen communiceren. Elk apparaat dat verbinding maakt met een netwerk heeft een IP-adres nodig!

  

In de begindagen van netwerken kenden we handmatig een IP-adres toe, maar dat is een omslachtige taak, vooral voor plaatsen met veel apparaten, zoals een bedrijfsomgeving. DHCP automatiseert dit proces gedeeltelijk, waardoor het veel gemakkelijker wordt om apparaten op het netwerk aan te sluiten. Dankzij DHCP is het gebruik van de beschikbare IP-adressen ook efficiënter in te vullen. Er moet niet gecontroleerd worden of het IP-adres nog beschikbaar is, dit wordt deels voor ons gedaan. DHCP-servers (of routers) handelen dit DHCP-proces af op basis van een reeks gedefinieerde regels.  Hierdoor hebben we weinig of geen kans op duplicate IP-adressen.

  

|   |
|---|
|De kans op dubbele IP-adressen onder DHCP-clients is wel bestaand. Omwille van problemen met leases en soms MAC-adressen, kunnen 2 clients hetzelfde IP-adres hebben. In dit geval zal de client die als laatste de lease heeft gekregen bereikbaar zijn via dat IP-adres en de eerste client zal niet meer te bereiken zijn. We kunnen “Conflict Detection” inschakelen in de properties van de DHCP-server zelf om dit te vermijden.<br><br>![](https://cdn.talentlms.com/it1education/1635067851_suru_uitroepteken.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwNjc4NTFfc3VydV91aXRyb2VwdGVrZW4ucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=ZVVjL-pC6cUgpWrOJpCltqvTS0OHvRqKKnumuFONg5SipTF0Q6GDZ3AePAPD%2Fw1nQrkeK1JXEKuwjxkHgUl6It4UU9uSgUChjSZwQ9k-Tfemn1VOqn9wct%2F%2FzN%2F1JShlGJpI2VwHZW%2F79lO8YS08Pq%2Fs5LJjYaxqFovWGTCNVeLQr2vwdPfw3nR9Yt3tB7c3XNbh4-VvCE1B8KuGyRuxcHoVI1P592RnnEC-IcpaOrUtEsU-eY3rtu1sJfnID6VNw-hgxL9bsNoowxZddRNC4zUzOFYS%2Fjemf2eMLPvh%2FOkGj5Z37s1E8RweQR7e8-Nk-Z9xXEzx3NO401jXB5J9%2Fw__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)We moeten dus ook opletten met duplicate MAC-adressen !! Het is mogelijk dat er 2 identieke MAC-adressen aanwezig zijn in het netwerk door bvb. "MAC Spoofing". Dit is een maskering van het MAC-adres aan de softwarekant, want hardwarematig kan een MAC-adres niet gewijzigd worden door een gebruiker. Het is uniek en gekoppeld aan de NIC van een bepaald device. We kunnen bvb. wel instellen dat DHCP werkt met een andere Client ID dan MAC, wat de standaard is. Dit doen we dan via optie "61" in de DHCP options.|

  

## D.O.R.A.

DORA is het proces dat doorlopen wordt wanneer een client een IP-adres vraagt aan de DHCP-server. Het staat voor "Discover - Offer - Request - Acknowledge".

  

![](https://cdn.talentlms.com/it1education/1635064887_DORA-proces.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwNjQ4ODdfRE9SQS1wcm9jZXMucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=Oa6UXJbZBSJIsqThJZXHE5m3q7UTnjyWKddotjB4smxa9EZmfJHe4u%2FDi57rOnSQvUZcPAQy1fDvfroYb5ROI8la31yBR4asxVa5w1xUiwl1dDCEHqX6I3WH99GRjrvgmZLN52qOOfnjiQGrIeErAqTnVSQNrwtvaQNYItSt517FZC9Qwt90G-ugmq8WYcCTD9T6hFOrhVSnrqqTq3UcOd3wJHoab8UqRM-Pc0vMSpuOPuSGDThk0OeGxw0qoFKyk3qT5bEJtxSgdkP8JsobIKvWhXh4IBszAL4-w8Ugv50-cNuno7vhpY31Ryn88s3uZ0wPkfScbNAMB-k6XJs%2FCg__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)Een toestel zal eerst een broadcast uitsturen, een "Discover". Het toestel vraagt aan de omgeving "Is er hier een server die mij een IP-adres kan bezorgen?" door dit naar overal uit te sturen.

Een DHCP-server antwoordt dan met een "Offer" in unicast met als antwoord "Ik heb deze IP-configuratie voor jou beschikbaar. Wil je deze gebruiken?" naar het vragende toestel.

Met nog een broadcast gaat het toestel een "Request" sturen: "Ja, ik zou graag deze configuratie willen gebruiken.". Dit gebeurt opnieuw over het hele netwerk. Op deze manier weet ook een 2de DHCP-server, waar load-balancing op geactiveerd is, dat dit adres via de 1ste DHCP-server is uitgedeeld.

De DHCP-server zal weer met een unicast antwoorden met een "Acknowledge" dat het toestel de IP-configuratie is toegekend en het zo in de lease list van de DHCP-server staat.

  

## Lease Time

Elke IP-configuratie die wordt uitgedeeld door de DHCP-server heeft een bepaalde lease time, een geldigheidstijd zeg maar. We kunnen deze tijd zelf bepalen. Afhankelijk van in welke omgeving de IP-configuratie gebruikt wordt, kunnen we dit verschillend instellen. Na het verstrijken van de lease time zal het toestel opnieuw moeten vragen aan de DHCP-server of het dat IP-adres eventueel verder kan gebruiken. Hierbij wordt niet het volledige DORA-proces opnieuw doorlopen. Er wordt enkel een nieuwe "Request" uitgestuurd die dan hopelijk wordt beantwoord met een positieve "Aknowledge". Indien de client een negatief antwoord krijgt van de DHCP-server, dan zal het volledige DORA-proces opnieuw doorlopen moeten worden.

  

|   |
|---|
|Binnen een bedrijfsomgeving is het interessanter om een iets langere lease time in te stellen omdat een bepaald toestel voor langere tijd een bepaald IP-adres mag behouden. Zo kunnen we ook het aantal "Requests" naar de DHCP-server verminderen. In een luchthaven bvb. zal er meer gekozen worden om een kortere lease time in te stellen. De mensen ![](https://cdn.talentlms.com/it1education/1635067851_suru_uitroepteken.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwNjc4NTFfc3VydV91aXRyb2VwdGVrZW4ucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=ZVVjL-pC6cUgpWrOJpCltqvTS0OHvRqKKnumuFONg5SipTF0Q6GDZ3AePAPD%2Fw1nQrkeK1JXEKuwjxkHgUl6It4UU9uSgUChjSZwQ9k-Tfemn1VOqn9wct%2F%2FzN%2F1JShlGJpI2VwHZW%2F79lO8YS08Pq%2Fs5LJjYaxqFovWGTCNVeLQr2vwdPfw3nR9Yt3tB7c3XNbh4-VvCE1B8KuGyRuxcHoVI1P592RnnEC-IcpaOrUtEsU-eY3rtu1sJfnID6VNw-hgxL9bsNoowxZddRNC4zUzOFYS%2Fjemf2eMLPvh%2FOkGj5Z37s1E8RweQR7e8-Nk-Z9xXEzx3NO401jXB5J9%2Fw__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)verblijven daar meestal niet zo lang en op die manier komt het "geleende" IP-adres terug sneller vrij.  <br><br>Het aanvragen van een verlenging van de IP-configuratie door een bepaald toestel heeft ook een gevolg op de lease time. Deze zal nl. maar half zo lang meer zijn. De lease time wordt dus telkens gehalveerd. Dit zal het geval zijn totdat de lease time "zero time" bereikt. Daarna begint het volledige DORA-proces opnieuw van voren af aan.|
## Installatie

![](https://cdn.talentlms.com/it1education/1635092797_install_dhcp.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwOTI3OTdfaW5zdGFsbF9kaGNwLnBuZyIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcxMTc1NjgwMH19fV19&Signature=dW3CpVsM4scRcGKSEkxBuuV6pDdhdaDPJbbHNxEsKQTrE8-9Z-4BFq9DqGmvQQ0yYqznFbFZMl6OetpHgilxjpaMDYDOe1VGfeooSgKik7nPaM0kSG-tbCj27P%2FFDtRTF0YXQ4071Ttxp-pjSMA%2FII461WoTrrsA2aC4fdPnIYjamtxr5V98GHIdFfyyfnEURx%2FrHygFqEAUofLNWJextSaT4MmhE7l3sgDbr-IHy4FvZwG7k7VTUHtNF414R6gDe3pOkQ0wB1hnCk3btm8dha4Fy9sOdcGRcAjoHBD6-VEgF2q0kaqz0%2FNs5asj7jekIYzr3-UCs0kDGueib29RsQ__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)Wat betreft de installatie van de rol DHCP kunnen we ook zowel grafisch werken als via Powershell. We beperken ons hier nu even tot het grafische. Grafisch moeten we, zoals voor heel veel zaken, in de Server Manager zijn. Daar gaan we door de wizard "Install Roles and Features" en kiezen de rol 'DHCP'. Deze rol installeren alleen is echter niet voldoende. Er moeten nog enkele zaken gebeuren... Sommige daarvan gebeuren automatisch op de achtergrond, andere moeten we zelf meegeven.

  

## Authorative?

Het is niet omdat de rol "DHCP" op een Windows Server wordt geïnstalleerd, dat deze server dan ook direct automatisch verantwoordelijk is voor het uitdelen van IP-configuraties. Een DHCP-server dient, naast configuratie uiteraard (dit is reeds ![](https://cdn.talentlms.com/it1education/1635086899_dhcp_authorisation_OK.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwODY4OTlfZGhjcF9hdXRob3Jpc2F0aW9uX09LLnBuZyIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcxMTc1NjgwMH19fV19&Signature=VELylXAl3pPEKcIZwU7VDeYivQK%2Fz1bAml8SXNL1iREBbGHGeC0Hy3mYQLUFGf6cOV4CXjKtnPdsyOs7AVmkVIYjF5pabdM-I6AT7iX-nRHKHPowMUI6QuQ5UJuZQhXZ7kTeZBWSKTk3f3pDssmKaKMes3t4wN7Q8BfuFgJpV1JF0VHF%2F4CAdYmj7Zq5exVbT3PzOC04ylyy1ZIUs57%2Fca-q2Nx8GpM1VEkTaAn5UmV0eGUUrWKVEkm3quPAkvDkNN1eZQ4DTfYEgcn6x5viUuPMxD-Gk3v5cosN4LyVYkYEdFfMUI3bbF%2F9ThB9e1tLqTzclBmnc51kh-9DoajkwA__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)mogelijk tijdens de installatie), ook geautoriseerd te worden alvorens die zijn taak kan vervullen. Dit "authorative" maken gebeurt via de wizard "Complete DHCP Configuration" en kan enkel maar gedaan worden door een domain administrator of account die ook lid is van die groep of van de "Enterprise Admins"-domeingroep. Dankzij het autorisatieproces wordt de DHCP-server erkend en toegestaan binnen het 'Active Directory'-domein of netwerk om zijn taak uit te voeren. 

  

Een DHCP-server authorative maken is ook belangrijk om zgn. "rogue" servers te vermijden. Wanneer we een standalone DHCP-server (Windows Server) zouden uitrollen in een bestaand netwerk, waarin Active Directory actief is, dan zal deze server niet geautoriseerd worden om te functioneren als DHCP-server. De server wordt dan herkend als een "rogue server". Door de DHCP-server lid te maken van het domein, zal deze wel geautoriseerd kunnen worden als volwaardige DHCP-server.  

  

|   |
|---|
|![](https://cdn.talentlms.com/it1education/1635067851_suru_uitroepteken.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwNjc4NTFfc3VydV91aXRyb2VwdGVrZW4ucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=ZVVjL-pC6cUgpWrOJpCltqvTS0OHvRqKKnumuFONg5SipTF0Q6GDZ3AePAPD%2Fw1nQrkeK1JXEKuwjxkHgUl6It4UU9uSgUChjSZwQ9k-Tfemn1VOqn9wct%2F%2FzN%2F1JShlGJpI2VwHZW%2F79lO8YS08Pq%2Fs5LJjYaxqFovWGTCNVeLQr2vwdPfw3nR9Yt3tB7c3XNbh4-VvCE1B8KuGyRuxcHoVI1P592RnnEC-IcpaOrUtEsU-eY3rtu1sJfnID6VNw-hgxL9bsNoowxZddRNC4zUzOFYS%2Fjemf2eMLPvh%2FOkGj5Z37s1E8RweQR7e8-Nk-Z9xXEzx3NO401jXB5J9%2Fw__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)Tijdens het autorisatieproces worden 2 groepen aangemaakt, nl. "DHCP Users" en "DHCP Administrators". Als we de rol installeren op een DC is dit geen probleem en zullen dit domeingroepen zijn. Als we DHCP echter op een member server installeren, dan zullen er op die member server lokale groepen aangemaakt worden i.p.v. domeingroepen en deze hebben niet de nodige rechten. Hierdoor zal de autorisatie van DHCP falen. We kunnen dit oplossen door de 2 nodige domeingroepen aan te maken op de DC en de server daarna te autoriseren.|
## Wat is een Scope?

Nadat we onze DHCP-server authorative hebben gemaakt, kunnen we nu beginnen met het configureren ervan. Dit doen we a.d.h.v. het manueel toevoegen van "scopes". Een scope is een set van bepaalde instellingen ![](https://cdn.talentlms.com/it1education/1635133739_dhcp_scope.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUxMzM3MzlfZGhjcF9zY29wZS5wbmciLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3MTE3NTY4MDB9fX1dfQ__&Signature=It2tgIIRfqCq2%2FdnjnGRqx8xFKYXrP4maf2YPNso-dxIpTkuNVc-6yyxUe8wTfu6r5zAZUShY3NvN-U-uaWB1djT7V9qC%2F50NPb6MLQb30IDW87T0VDjeoJUSC2-opL0pgSwrfY%2FvXa8TxptfkWvt1mgs0MPxL6-2lksiEWmPqIsTiZ2CnvC6iPu9YAqSIinClz9ZFsHw9mYDpIk8Kpx4%2FCe8%2FraQ8UfKP4kq7Nv6anBCs8HTcUVhLFd9f5OdBT6hdmkR2CTqfJo6-exRaJm1HPMZQWkt-8pqQmnMWW6LUh4l%2F6lfO8me04g40mg6lfQZrmE3ebXfhk-taJKYwIHfQ__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)waaronder IP-range, exclusions, reservations, DHCP options en lease time. Het is perfect mogelijk en soms ook nodig om meerdere scopes in te stellen op 1 DHCP-server.

  

### IP-range  

Dit is de verzameling IP-adressen uit een bepaalde range waaruit de DHCP-server kan kiezen om deze uit te delen aan de clients. Het wordt aanbevolen om deze ALTIJD zo groot/volledig mogelijk te nemen. De reden hiervoor is dat, eens een IP-range is toegekend aan een scope, deze nadien niet meer veranderd kan worden. De enige manier om dit aan te passen is de scope opnieuw aan te maken. Er kan dus slechts 1 subnet per scope toegewezen worden. Indien we meerdere subnetten (IP-ranges) willen configureren op de DHCP-server, dan moeten we meerdere scopes aanmaken.

  

### Exclusions  

Wanneer we IP-adressen toevoegen aan de "Exclusions", dan kunnen deze niet uitgedeeld worden door de DHCP-server. Dit is onder andere handig om bepaalde static IP's die we reeds hebben ingesteld binnen het netwerk uit te sluiten zodat deze niet meer kunnen worden toegekend aan andere toestellen binnen het netwerk. Op die manier vermijden we problemen.

  

### Reservations  

Reservations zijn gereserveerde IP-adressen uit de scope's IP-range die niet meer gebruikt kunnen worden om uit te delen. (Meer hierover in het onderdeel "Reservations" verderop).

  

### DHCP Options  

Dit is eigenlijk extra informatie die we meegeven op de DHCP-server die dan kan gebruikt worden voor het uitdelen van IP-configuraties. (We gaan dit uitgebreider behandelen in het volgende onderdeel "Scope Options").

  

### Lease Time  

Een lease time is een geldigheidsduur. (We hebben dit reeds besproken in het onderdeel "D.O.R.A.").

## Wat zijn DHCP Options?

Het is jullie misschien al opgevallen dat er wordt gesproken over IP-configuratie en niet enkel over IP-adres. Het is ook zo dat uitsluitend een IP-adres uitdelen aan een apparaat niet voldoende zou zijn om dit toestel binnen het netwerk te kunnen herkennen en gebruiken. Daarvoor zijn nog enkele andere parameters dan IP-adres nodig. Deze kunnen we o.a. meegeven via de DHCP options naast nog enkele andere configuraties.

![](https://cdn.talentlms.com/it1education/1635134142_scope_options_overzicht.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUxMzQxNDJfc2NvcGVfb3B0aW9uc19vdmVyemljaHQucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=dax%2FXlrmw1uD5vvPmV4kxCjnJB2AB0fXuTSCniCY8Q7In9KyMHJe%2FGjNZoD2xDTQoDzdAcBY%2Fro8%2FVcERhSkRP-oCmptOCdBGrVlgodN-H9lD54jbkHFPHquzZqokDACdMbUnBH3Xj8nOcXr9AI7PErdfhbKXR-mDUxbVSRHtZ1tnFIFVgcWbosi7oX5L7ubd6ab5K12%2FCUwflXMwY8GkADbGZvPMlVD0QnCwhTFB1x6AXBbPpiJBi6ERQ%2FMAfyft5oGoT32tM-9lExc91HRsVSiPxqXYgbpRXILM9lkpG0p4w6IhsekqbYDCNGFIyRJplV7sC9c6TB-FOXr7PcNqg__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)  

Binnen DHCP Options zijn een paar instellingen die we sowieso "moeten" of best meegeven tijdens de configuratie van een DHCP-server. Zo is het handig dat bij het toekennen van een IP-configuratie ook de default gateway, het IP-adres van de DNS-server, de domeinnaam, ... als parameters worden mee uitgedeeld. Op die manier zijn we zeker dat een toestel een correcte IP-setting krijgt toebedeeld.

  

We kunnen deze instellen op zowel scope- als serverniveau. Server options, parameters instellen op serverniveau, betekent dat de opties gekoppeld zijn aan de DHCP-server. Ze zullen enkel toegepast worden op een scope indien er geen aparte scope options zijn ingesteld. Scope options werken dan weer per scope en hoeven niet noodzakelijk hetzelfde te zijn per scope. Welke van de 2 nu de beste optie is hangt af van de omgeving, hoeveel scopes er actief zijn op een DHCP-server, ...

## Wat zijn Reservations?

In een bedrijfsnetwerk zijn heel wat verschillende apparaten aanwezig: servers, clientpc's, printers, ... Sommige daarvan gaan we een statisch IP-adres geven (bvb. servers), andere dan weer een dynamisch of DHCP-adres. Voor bepaalde toestellen kan het toch handig zijn om telkens hetzelfde IP-adres te krijgen zonder dit statisch te hoeven instellen. Hiervoor kunnen we "Reservations" gebruiken.

  

![](https://cdn.talentlms.com/it1education/1656234077_reservations.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2NTYyMzQwNzdfcmVzZXJ2YXRpb25zLnBuZyIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcxMTc1NjgwMH19fV19&Signature=K39Hbkk8rqyEfUU5rNpMA3C6KjJsL3prspk7JpQkpha88eJFTe8X1WHao6ro1vVMmYQ86inhT6g9fXPYECkrOMjji0qP12iBVXb7R0CBzNSG9iKAw3UlHpxWc6LpXMbBRzRoMd92NRK3Lz5V3LLRTx1Ffbp9l4Dloq71TEf526DZBhZR9q6mlg7uHz2rjmmxhPC6q7fKn8LXpcu%2Fe1aC2Y0EKH04PbokQ0uY8zjyj-3ukpkUfJYCuCcu13YtTWaYwSMufDgSSrbntN-ihitW7zpZ2kzw2b8nsTObKfxyYsaaqB7fLWyI0KafovbpIu%2FmlJ8m3aMERUGLgq5w1Axxqg__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)Met "Reservations" gaan we IP-adressen uit de IP-range van een scope reserveren voor een bepaald toestel. Het apparaat staat wel ingesteld om een dynamische IP-configuratie te verkrijgen, maar zal toch telkens hetzelfde IP-adres toegewezen krijgen. We doen dit door een IP-adres te koppelen aan een bepaald MAC-adres. Op die manier weet de DHCP-server dat iedere keer dit bepaalde IP-adres aan het toestel met dat meegegeven MAC-adres moet uitgedeeld worden.

  

|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ![](https://cdn.talentlms.com/it1education/1635067851_suru_uitroepteken.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwNjc4NTFfc3VydV91aXRyb2VwdGVrZW4ucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=ZVVjL-pC6cUgpWrOJpCltqvTS0OHvRqKKnumuFONg5SipTF0Q6GDZ3AePAPD%2Fw1nQrkeK1JXEKuwjxkHgUl6It4UU9uSgUChjSZwQ9k-Tfemn1VOqn9wct%2F%2FzN%2F1JShlGJpI2VwHZW%2F79lO8YS08Pq%2Fs5LJjYaxqFovWGTCNVeLQr2vwdPfw3nR9Yt3tB7c3XNbh4-VvCE1B8KuGyRuxcHoVI1P592RnnEC-IcpaOrUtEsU-eY3rtu1sJfnID6VNw-hgxL9bsNoowxZddRNC4zUzOFYS%2Fjemf2eMLPvh%2FOkGj5Z37s1E8RweQR7e8-Nk-Z9xXEzx3NO401jXB5J9%2Fw__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)Reservations worden vaak gebruikt bij bepaalde apparaten zoals printers, scanners, ... Deze apparaten hebben soms een netwerkaansluiting maar dan moeten we deze apparaten nog gaan zoeken op het netwerk. Sommige hebben wel een LED-interface maar dit is vaak eerst wat zoeken om een IP-adres in te stellen. Op deze apparaten staat meestal het MAC-adres duidelijk vermeld en dan kan je dit gebruiken om een reservation te maken. |
## Reservation configureren

Reservations worden aangemaakt op scopeniveau binnen de console DHCP. Door rechts te klikken op 'Reservations' en te kiezen voor "New Reservation..." kunnen we een IP-adres reserveren. We geven dan het gewenste IP-adres in en het MAC-adres van het toestel waarvoor we deze reservatie willen instellen. Daarnaast kunnen we ook 'Supported types' meegeven. We hebben de keuze uit DHCP, BOOTP of Both. De standaardinstelling 'Both' laten staan is hier eigenlijk de juiste keuze.

  
![](https://cdn.talentlms.com/it1education/1635137035_new_reservation.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUxMzcwMzVfbmV3X3Jlc2VydmF0aW9uLnBuZyIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcxMTc1NjgwMH19fV19&Signature=D609dqWpMPBKxe8oMYD2IQS5smavpWUEf5s%2FDyCbdCGwDDUxEEgpK4iedg5viWnYfjAfZ4kOacKyvrfNMQPuDVjC0vUjd5Ujao28BUcpJSMzFghB-7Z8wNjLq%2F6z2O-EnRkTegGlkof%2F7FVgeuEQFUVNIEmAYNyu20gJynN7QD6MgUsxIQ5qz83lcnXXyzbnfXJknFwyGQmraPS8g0%2F0dDy6UQbK25UpAdjTgU8vVKDXMz6AYhbMKe%2FkJjJFT2Kh425M-TdpkS7iTvepBfCssgUyO6HDTENq6Ao9wPlwIkwAwnzgo1skq%2FEb%2FBvdTGeNn4mGFEE8sw0tJPFPfo8cZg__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)

|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| BOOTP en DHCP zijn de protocollen die een host gebruikt om toegang te krijgen tot IP-parameters van de server of om deze te configureren.<br><br>BOOTP (Bootstrap Protocol) is een internetprotocol waarmee een netwerkgebruiker automatisch kan worden geconfigureerd om een ​​IP-adres ![](https://cdn.talentlms.com/it1education/1635067851_suru_uitroepteken.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUwNjc4NTFfc3VydV91aXRyb2VwdGVrZW4ucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=ZVVjL-pC6cUgpWrOJpCltqvTS0OHvRqKKnumuFONg5SipTF0Q6GDZ3AePAPD%2Fw1nQrkeK1JXEKuwjxkHgUl6It4UU9uSgUChjSZwQ9k-Tfemn1VOqn9wct%2F%2FzN%2F1JShlGJpI2VwHZW%2F79lO8YS08Pq%2Fs5LJjYaxqFovWGTCNVeLQr2vwdPfw3nR9Yt3tB7c3XNbh4-VvCE1B8KuGyRuxcHoVI1P592RnnEC-IcpaOrUtEsU-eY3rtu1sJfnID6VNw-hgxL9bsNoowxZddRNC4zUzOFYS%2Fjemf2eMLPvh%2FOkGj5Z37s1E8RweQR7e8-Nk-Z9xXEzx3NO401jXB5J9%2Fw__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)te ontvangen en een besturingssysteem te laten opstarten zonder tussenkomst van de gebruiker. <br><br>Tegenwoordig wordt BOOTP uitgevoerd met behulp van UDP en vormt het de basis voor DHCP. DHCP-servers worden gebruikt om clientverzoeken te ontvangen. |
## Wat is DHCP Relay Agent?

Om pakketten tussen een DHCP-client en een DHCP-server uit te wisselen, moeten zowel de client als de server zich op hetzelfde subnet bevinden. Dat komt omdat routers geen broadcast-IP-pakket naar andere ![](https://cdn.talentlms.com/it1education/1635154073_dhcp_relay_agent_config.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUxNTQwNzNfZGhjcF9yZWxheV9hZ2VudF9jb25maWcucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzExNzU2ODAwfX19XX0_&Signature=T1rJ1gR-W2HHic1x6SStY1uFjrqeC18ySY1fhHudf%2FXI%2FrYCA0z%2F2Iyfv-eJls1%2F3l3AKMbggFA-eDySBO7zm7N2TavycyX6LXRrpXaOm%2FY5NLmId2TeZVtC-M1dafrGn1CcQvnkAPBQMsHmfwZXl9CxfdTj-K8EO1qB2OZCW5ANwDCV2lYpBmYqMg0NC62KmCvIYNuB3u2Zt%2FA6Pk3-AVEriEq1NHsUnf5QdsREQ%2FlX28xfN5SutUoANmT5Mfe%2FKsyJLmAhIPAkn4t-7tvaxBnLQTGWHlVhxVj7avIwYSj8hKm3h3%2Fz-cweTt-AYzZbsPNUpo99Td8qUFUJrTigIg__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)interfaces doorsturen maar die droppen. Een "Discover" is een broadcast-DHCP-pakket en kan dus niet via een router. Deze beperking zou vereisen dat alle individuele subnetten een eigen DHCP-server hebben voor DHCP-werking, wat praktisch niet echt haalbaar is. Er zouden immers te veel DHCP-servers zijn vereist in het netwerk! 

  

Gelukkig is er het concept van "DHCP Relay Agent" om dit probleem aan te pakken. De kernfunctie van deze DHCP Relay Agent is het converteren van een DHCP-broadcast-pakket naar een unicast-pakket en dit dan door te sturen naar een DHCP-server.

## Hoe instellen?

De DHCP Relay Agent wordt altijd op routers, of apparaten die routing mogelijk maken, geïmplementeerd. Configureren doen we op de interface die verbonden is met het netwerk van de DHCP-client. We geven hierbij het IP-adres van de DHCP-server mee.  Op andere OS's krijgt DHCP Relay Agent wel eens een andere naam. Bij Cisco spreekt men bvb. van "IP Helper".  

  
![](https://cdn.talentlms.com/it1education/1635153899_dhcp_relay_agent_1.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUxNTM4OTlfZGhjcF9yZWxheV9hZ2VudF8xLnBuZyIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcxMTc1NjgwMH19fV19&Signature=JHI9nhuXq6gOjLVyAiJuRrSkWhEfMGdar-lqRdD7gLpEL4y4Ouwk1jL3iuK8HLt94N1xjhfavR6lr0Tre8zgY9-5YntaObCcE4Fc2fObvrjYX77HuQ-3iRjA2yQfq4Fj8%2FbUpZvHX7J1rqdMS2XpjfLlZ6XNohRmoRON0IwypNbj3dPhfhlj8hBB3ezlyJU-A8jGgYSYOr26EBbTSI%2FjiAjaMI3CzquU4TfP0nUKGHcqfTjhuc7Rc1cUSOp56g--q9wsX5rJF68RwOCKBX09vRNNQBV3YBVqzAgaRMeKgXfsgZ9x3sn4YN44GzIinoAgh3Ic5tOze%2FKOFG1It%2FYbGg__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)

![](https://cdn.talentlms.com/it1education/1635153919_dhcp_relay_agent_2.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6XC9cL2Nkbi50YWxlbnRsbXMuY29tXC9pdDFlZHVjYXRpb25cLzE2MzUxNTM5MTlfZGhjcF9yZWxheV9hZ2VudF8yLnBuZyIsIkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTcxMTc1NjgwMH19fV19&Signature=VnWvVLyMZxhza%2FQuRtoUM8pIYPJ77zeX4bPAyRa5BzPahsrd9Kx0D%2FJ-faZxVvQP4fcPvtJjiDufdmJWqXcM4POFyT5izIHlYHxmlm0vS2OZqJ5OXS0MwOBYv3%2FaLA3R0Mqn4fG1Ov1co2dQTDL31Ei%2FpdQ%2FL5kCmyCrVZn-mFEpczj%2FFE0SO3NKxS0mJfT1BoOFeFuG9gJ9uT3ciZpQ1K-YI-uc6BMigcy3IE%2FUVaFxOPdG6CjKm52Fucp6I58hUYzQtoCDJcbBYum-ryKbJDCe1ERFw7qwkAcuQ49b7N7RnnLpHRqvSqjGwaFgXLMCGzN6ui3G%2Fu8j%2FA8R0XIu2A__&Key-Pair-Id=APKAJDCWVQTW4P3KI3XA)
|   |
|---|
|1. De DHCP-client broadcasts een Discover.  <br><br>2. De DHCP Relay Agent ontvangt dit bericht dat door de pc wordt uitgezonden en unicast deze rechtstreeks naar de DHCP-server. <br><br>> Op dit punt slaat de DHCP Relay Agent het IP-adres (het interface-adres waarop hij de DHCP Discover heeft ontvangen) op in het veld "Relay Agent IP" van het door te sturen DHCP-bericht.<br><br>3. De DHCP-server unicasts een DHCP-Offer (bestemmings-IP-adres ingesteld als het IP-adres van de Relay Agent) naar de DHCP Relay Agent. <br><br>> De DHCP Relay Agent vervangt het IP-adres van de bestemming door het IP-adres van de pc. Het vervangt ook het bron-IP-adres door het IP-adres van de DHCP Relay Agent en stuurt het gewijzigde bericht door naar de pc.<br><br>4. De DHCP-client broadcasts een Request.<br><br>5. De DHCP Relay Agent ontvangt dit bericht dat door de pc wordt uitgezonden en unicasts deze rechtstreeks naar de DHCP-server. <br><br>> Op dit punt slaat de DHCP Relay Agent het IP-adres (het interface-adres waarop hij het DHCP Request heeft ontvangen) op in het veld "Relay Agent IP" van het door te sturen DHCP-bericht. <br><br>6. (De DHCP-server unicasts een DHCP-Acknowlegde (bestemmings-IP-adres ingesteld als het IP-adres van de Relay Agent) naar de DHCP Relay Agent. <br><br>> De DHCP Relay Agent vervangt het IP-adres van de bestemming door het IP-adres van de pc. Het vervangt ook het bron-IP-adres door het IP-adres van de DHCP Relay Agent en stuurt het gewijzigde bericht door naar de pc.|